(this["webpackJsonpspotty-sky"]=this["webpackJsonpspotty-sky"]||[]).push([[0],{25:function(t,e,n){},29:function(t,e,n){t.exports=n(42)},40:function(t,e,n){},41:function(t,e,n){},42:function(t,e,n){"use strict";n.r(e);var r=n(0),a=n.n(r),c=n(14),o=n.n(c),i=n(10),s=n(12),u=n(16);function p(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function l(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?p(n,!0).forEach((function(e){Object(u.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):p(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function f(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}var h=Object(s.b)({auth:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"GEN_TOKEN":return l({},t,{token:e.token});case"DEL_TOKEN":return l({},t,{token:null});default:return t}},weather:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;switch(e.type){case"UPDATE_WEATHER":return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?f(n,!0).forEach((function(e){Object(u.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):f(n).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},t,{},e.weather);default:return t}}}),m=(n(25),n(2)),d=n.n(m),y=n(4),b=n(17),v=n(11),O=n(28);function k(t){var e=document.cookie.match("(^|;) ?".concat(t,"=([^;]*)(;|$)"));return e?e[2]:null}function j(t,e,n){var r=new Date;r.setTime(r.getTime()+1e3*n),document.cookie="".concat(t,"=").concat(e,";path=/;expires=").concat(r.toGMTString())}var w=function(t){return{type:"GEN_TOKEN",token:t}};function E(){return j("token","",-1),{type:"DEL_TOKEN"}}var g=function(t){return{type:"UPDATE_WEATHER",weather:t}},x="https://accounts.spotify.com/authorize",_="878fc98b349842e59c5c057bb5dff9ff",P="".concat(window.location.origin,"/redirect"),N=encodeURIComponent("user-top-read playlist-modify-public playlist-modify-private");function S(t){return T.apply(this,arguments)}function T(){return(T=Object(y.a)(d.a.mark((function t(e){var n,r,a,c,o,i,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.token,r=e.type,a=e.page,c=void 0===a?0:a,o=e.limit,i=void 0===o?5:o,t.next=3,fetch("https://api.spotify.com/v1/me/top/".concat(r,"?limit=").concat(i,"&offset=").concat(c*i),{method:"GET",headers:{Authorization:"Bearer ".concat(n)}});case 3:return s=t.sent,t.abrupt("return",s.json());case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function D(t){return A.apply(this,arguments)}function A(){return(A=Object(y.a)(d.a.mark((function t(e){var n,r,a,c,o,i,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.token,r=e.limit,a=void 0===r?100:r,c=e.seedArtists,o=e.seedTracks,i=c?"&seed_artists=".concat(c.join(",")):"",i=o?"".concat(i,"&seed_tracks=").concat(o.join(",")):i,t.next=5,fetch("https://api.spotify.com/v1/recommendations?limit=".concat(a).concat(i),{method:"GET",headers:{Authorization:"Bearer ".concat(n)}});case 5:return s=t.sent,t.abrupt("return",s.json());case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function C(t,e){return B.apply(this,arguments)}function B(){return(B=Object(y.a)(d.a.mark((function t(e,n){var r;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://api.spotify.com/v1/audio-features/?ids=".concat(n.join(",")),{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});case 2:return r=t.sent,t.abrupt("return",r.json());case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function G(t){return z.apply(this,arguments)}function z(){return(z=Object(y.a)(d.a.mark((function t(e){var n;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:"Bearer ".concat(e)}});case 2:return n=t.sent,t.abrupt("return",n.json());case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function I(t){return J.apply(this,arguments)}function J(){return(J=Object(y.a)(d.a.mark((function t(e){var n,r,a,c,o,i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.token,r=e.userId,a=e.name,c=e.description,o=a||"spotty sky playlist - ".concat((new Date).toLocaleDateString()),t.next=4,fetch("https://api.spotify.com/v1/users/".concat(r,"/playlists"),{method:"POST",headers:{Accept:"application/json",Authorization:"Bearer ".concat(n),"Content-Type":"application/json"},body:JSON.stringify({name:o,description:c,public:!1})});case 4:return i=t.sent,t.next=7,i.json();case 7:return t.abrupt("return",t.sent.id);case 8:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function R(t){return L.apply(this,arguments)}function L(){return(L=Object(y.a)(d.a.mark((function t(e){var n,r,a,c;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.token,r=e.playlistId,a=e.tracks,c=fetch("https://api.spotify.com/v1/playlists/".concat(r,"/tracks?uris=").concat(a.join(",")),{method:"POST",headers:{Authorization:"Bearer ".concat(n),"Content-Type":"application/json"}}),t.abrupt("return",c);case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function M(){var t="".concat(x,"?client_id=").concat(_).concat(N&&"&scope=".concat(N),"&redirect_uri=").concat(P,"&response_type=token&show_dialog=true"),e=Object(i.b)(),n=Object(i.c)((function(t){return t.auth.token}));return Object(r.useEffect)((function(){console.log(k("token")),k("token")&&!n&&e(w(k("token")))}),[e,n]),a.a.createElement("div",{className:"login"},n?a.a.createElement("a",{className:"btn",href:"/logout"},"Logout"):a.a.createElement("a",{className:"btn",href:t},"Login to Spotify"),a.a.createElement(O.a,{basename:"/"},a.a.createElement(v.b,{path:"/redirect",component:function(){return e(function(t){var e={};return t.substring(1).split("&").forEach((function(t){e[t.split("=")[0]]=decodeURIComponent(t.split("=")[1])})),j("token",e.access_token,e.expires_in),w(e.access_token)}(window.location.hash)),a.a.createElement(v.a,{to:"/"})}}),a.a.createElement(v.b,{path:"/logout",component:function(){return e(E()),a.a.createElement(v.a,{to:"/"})}})))}n(40);function U(t){var e=t.checked,n=void 0===e||e,r=t.title,c=t.children;return a.a.createElement("code",null,a.a.createElement("label",{htmlFor:"code__".concat(r.replace(/\s+/g,"_"))},a.a.createElement("input",{id:"code__".concat(r.replace(/\s+/g,"_")),type:"checkbox",defaultChecked:n}),a.a.createElement("span",{className:"title"},r),a.a.createElement("div",{className:"content"},c)))}n(41);var W=n(22);function K(t,e){return H.apply(this,arguments)}function H(){return(H=Object(y.a)(d.a.mark((function t(e,n){var r,a,c,o,i;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=[],t.prev=1,t.next=4,S({token:e,type:"tracks"});case 4:return a=t.sent,c=Promise.all(a.items.map((function(t){return t.id}))),t.t0=D,t.t1=e,t.next=10,c;case 10:return t.t2=t.sent,t.t3={token:t.t1,seedTracks:t.t2},t.next=14,(0,t.t0)(t.t3);case 14:return o=t.sent,t.next=17,C(e,o.tracks.map((function(t){return t.id})));case 17:i=(i=t.sent).audio_features.filter((function(t){return Math.abs(t.valence-.01*n.clouds.all)>.5})),r=[].concat(Object(W.a)(r),Object(W.a)(i)),t.next=25;break;case 22:t.prev=22,t.t4=t.catch(1),console.log(t.t4);case 25:return t.abrupt("return",r);case 26:case"end":return t.stop()}}),t,null,[[1,22]])})))).apply(this,arguments)}function Y(){return(Y=Object(y.a)(d.a.mark((function t(e){var n,r,a,c,o,i,s;return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=e.token,r=e.name,a=e.limit,c=e.playlist,t.next=3,G(n);case 3:return o=t.sent,i=new Date,t.next=7,I({token:n,userId:o.id,name:r,description:"Created on ".concat(i.getMonth()+1,"/").concat(i.getDate()," via ").concat(window.location)});case 7:s=t.sent,R({token:n,playlistId:s,tracks:c.slice(0,a).map((function(t){return t.uri}))});case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function $(){var t,e=Object(i.c)((function(t){return t.auth.token})),n=Object(i.c)((function(t){return t.weather})),c=Object(i.b)(),o=Object(r.useState)(),s=Object(b.a)(o,2),u=s[0],p=s[1],l=Object(r.useState)([]),f=Object(b.a)(l,2),h=f[0],m=f[1],v=Object(r.useState)("rbga(255,255,255,1)"),O=Object(b.a)(v,2),k=O[0],j=O[1],w=Object(r.useRef)(null);return Object(r.useEffect)((function(){var t="q=New York, NY, US";function n(){return r.apply(this,arguments)}function r(){return(r=Object(y.a)(d.a.mark((function e(){var n,r,a;return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n="https://community-open-weather-map.p.rapidapi.com/weather?".concat(t,"&units=imperial"),e.next=3,fetch(n,{method:"GET",headers:{"x-rapidapi-host":"community-open-weather-map.p.rapidapi.com","x-rapidapi-key":"15fe13f990msha0b23062c32707cp148f84jsn17e58c929a3f"}});case 3:return r=e.sent,e.next=6,r.json();case 6:a=e.sent,j("rgba(255,167,22,".concat(1-.01*a.clouds.all,")")),c(g(a)),p("Music based on ".concat(a.name," weather..."));case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}e&&(navigator.geolocation?navigator.geolocation.getCurrentPosition((function(e){t="lat=".concat(e.coords.latitude,"&lon=").concat(e.coords.longitude),n()}),(function(){return n()})):n())}),[c,e]),e&&(t=a.a.createElement("div",{className:"player__container"},a.a.createElement("h1",null,"Spotty Sky"),a.a.createElement("h2",null,u),a.a.createElement("div",{className:"flex controls"},a.a.createElement("button",{type:"button",onClick:Object(y.a)(d.a.mark((function t(){return d.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0=m,t.next=3,K(e,n);case 3:return t.t1=t.sent,t.abrupt("return",(0,t.t0)(t.t1));case 5:case"end":return t.stop()}}),t)})))},"Load Songs"),h.length>0&&a.a.createElement("div",null,a.a.createElement("input",{type:"text",placeholder:"My awesome playlist",ref:w}),a.a.createElement("button",{type:"button",onClick:function(){return function(t){return Y.apply(this,arguments)}({token:e,name:w.current.value,limit:30,playlist:h})}},"Save playlist"))),a.a.createElement(U,{title:"Weather (JSON Response)"},JSON.stringify(n)),a.a.createElement(U,{title:"Playlist (JSON Response)"},JSON.stringify(h)))),a.a.createElement("div",{className:"player",style:{background:k}},a.a.createElement(M,null),t)}var q=function(){return a.a.createElement("div",{className:"App"},a.a.createElement($,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var F=Object(s.c)(h);o.a.render(a.a.createElement(i.a,{store:F},a.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(t){t.unregister()}))}},[[29,1,2]]]);
//# sourceMappingURL=main.b9106c2e.chunk.js.map